import re
import pandas as pd

# 텍스트 파일에서 데이터를 읽어옵니다 (인코딩을 cp949로 지정)
with open("packet_data.txt", "r", encoding="cp949") as file:
    data = file.read()

# "password" 파라미터 값을 추출하는 정규 표현식
passwords = re.findall(r"password=([^&\s]+)", data)

# 데이터프레임으로 변환하여 엑셀로 저장
df = pd.DataFrame(passwords, columns=["Password"])
df.to_excel("passwords.xlsx", index=False)
