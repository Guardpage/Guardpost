import re
import pandas as pd

# 텍스트 파일에서 데이터를 읽어옵니다 (인코딩을 utf-8로 지정하고 에러 무시)
with open("packet_data.txt", "r", encoding="utf-8", errors="ignore") as file:
    data = file.read()

# "password" 또는 "password2" 뒤에 오는 값을 추출하는 정규 표현식
passwords = re.findall(r"(password|password2):([\w]+)", data)

# 결과를 데이터프레임으로 변환
df = pd.DataFrame(passwords, columns=["Parameter", "Value"])
df.to_excel("passwords.xlsx", index=False)
