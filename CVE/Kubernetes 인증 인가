ğŸš€ ì¿ ë²„ë„¤í‹°ìŠ¤ ì¸ì¦/ì¸ê°€ ì·¨ì•½ì 
âœ… ëª©í‘œ: ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ kubelet ì¸ì¦/ì¸ê°€ ì·¨ì•½ì ì„ í™œìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ íƒˆì·¨
âœ… í™˜ê²½: Ubuntu 20.04
âœ… êµ¬ì„± ìš”ì†Œ: Kubernetes	v1.28.15 kubeletctl	v1.9 Docker	v20.10.7 containerd	v1.6.4 Calico CNI	v3.26.1


ğŸ”¥ 1. ì‹œìŠ¤í…œ ì¤€ë¹„ (í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜ & ì„¤ì •)
# íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸ ë° í•„ìˆ˜ ë„êµ¬ ì„¤ì¹˜
sudo apt update && sudo apt upgrade -y
sudo apt install -y curl apt-transport-https ca-certificates gnupg2 software-properties-common jq

# Swap ë¹„í™œì„±í™” (ì¿ ë²„ë„¤í‹°ìŠ¤ ìš”êµ¬ì‚¬í•­)
sudo swapoff -a
sudo sed -i '/ swap / s/^/#/' /etc/fstab

# Docker ì„¤ì¹˜
sudo apt install -y docker.io
sudo systemctl enable --now docker
sudo usermod -aG docker $USER
ğŸ‘‰ âš ï¸ ë¡œê·¸ì•„ì›ƒ í›„ ë‹¤ì‹œ ë¡œê·¸ì¸ í•„ìš” (docker ëª…ë ¹ì–´ ì‚¬ìš© ê°€ëŠ¥í•˜ë„ë¡ ì ìš©ë¨).

ğŸ”¥ 2. Kubernetes ì„¤ì¹˜ ë° ì´ˆê¸°í™”
# Kubernetes ì €ì¥ì†Œ í‚¤ ë° ì €ì¥ì†Œ ì¶”ê°€
sudo mkdir -p /etc/apt/keyrings
curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.28/deb/Release.key | sudo tee /etc/apt/keyrings/kubernetes-apt-keyring.asc > /dev/null
echo "deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.asc] https://pkgs.k8s.io/core:/stable:/v1.28/deb/ /" | sudo tee /etc/apt/sources.list.d/kubernetes.list

# Kubernetes ì„¤ì¹˜
sudo apt update
sudo apt install -y kubelet kubeadm kubectl
sudo systemctl enable --now kubelet

# ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì´ˆê¸°í™”
sudo kubeadm init --pod-network-cidr=192.168.0.0/16

# kubeconfig ì„¤ì • (ì‚¬ìš©ì ê³„ì • ì ìš©)
mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config

# ë„¤íŠ¸ì›Œí¬ í”ŒëŸ¬ê·¸ì¸ (Calico) ì„¤ì¹˜
kubectl apply -f https://raw.githubusercontent.com/projectcalico/calico/v3.26.1/manifests/calico.yaml
ğŸ‘‰ kubectl get nodes ì‹¤í–‰í•˜ì—¬ Ready ìƒíƒœ í™•ì¸.

ğŸ”¥ 3. kubelet API ì¸ì¦/ì¸ê°€ ì·¨ì•½ì  ì„¤ì •
# kubelet ì„¤ì • ìˆ˜ì • (ìµëª… ì ‘ê·¼ í—ˆìš©)
sudo vi /var/lib/kubelet/config.yaml
ğŸ‘‰ ì•„ë˜ ë‚´ìš© ìˆ˜ì • (ì¶”ê°€/ë³€ê²½)
authentication:
  anonymous:
    enabled: true
authorization:
  mode: AlwaysAllow

# kubelet ì¬ì‹œì‘
sudo systemctl restart kubelet
ğŸ‘‰ ì¿ ë²„ë„¤í‹°ìŠ¤ Kubelet APIê°€ ì¸ì¦ ì—†ì´ ì ‘ê·¼ ê°€ëŠ¥í•´ì§.

ğŸ”¥ 4. MariaDB íŒŒë“œ ë°°í¬
kubectl apply -f - <<EOF
apiVersion: v1
kind: Pod
metadata:
  name: mariadb
  namespace: default
spec:
  containers:
  - name: mariadb
    image: mariadb:latest
    env:
    - name: MYSQL_ROOT_PASSWORD
      value: "rootpassword"
EOF

# íŒŒë“œ ìƒíƒœ í™•ì¸ (Running ìƒíƒœ í™•ì¸)
kubectl get pods -n default

ğŸ”¥ 5. kubelet API í™œìš©í•˜ì—¬ ê³µê²© ì‹¤ìŠµ

# kubelet API ì§ì ‘ í˜¸ì¶œ (íŒŒë“œ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°)
curl -k https://127.0.0.1:10250/pods | jq

# kubeletctl ë„êµ¬ ì„¤ì¹˜
wget https://github.com/cyberark/kubeletctl/releases/download/v1.9/kubeletctl_linux_amd64
chmod +x kubeletctl_linux_amd64
sudo mv kubeletctl_linux_amd64 /usr/local/bin/kubeletctl

# kubeletctlë¡œ MariaDB í™˜ê²½ ë³€ìˆ˜ ê°€ì ¸ì˜¤ê¸°
kubeletctl exec -n default -p mariadb -c mariadb -- /bin/sh -c 'env | grep MYSQL'
ğŸ‘‰ ì¶œë ¥ ì˜ˆì‹œ (MYSQL_ROOT_PASSWORD=rootpassword)


# kubeletctlë¡œ MariaDB ë‚´ë¶€ ì ‘ê·¼ í›„ ë°ì´í„°ë² ì´ìŠ¤ íƒˆì·¨
kubeletctl exec -n default -p mariadb -c mariadb -- /bin/sh -c 'mysql -u root -p$MYSQL_ROOT_PASSWORD -e "SHOW DATABASES;"'
ğŸ‘‰ ì¶œë ¥ ì˜ˆì‹œ: information_schema, mysql, performance_schema, sys
