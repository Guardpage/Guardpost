import re
import pandas as pd

# 텍스트 파일에서 데이터를 읽어옵니다 (인코딩을 utf-8로 지정하고 에러 무시)
with open("packet_data.txt", "r", encoding="utf-8", errors="ignore") as file:
    data = file.read()

# "password:" 뒤에 오는 값을 추출하는 정규 표현식
passwords = re.findall(r"password:([\w]+)", data)

# 데이터프레임으로 변환하여 엑셀로 저장
df = pd.DataFrame(passwords, columns=["Password"])
df.to_excel("passwords.xlsx", index=False)
